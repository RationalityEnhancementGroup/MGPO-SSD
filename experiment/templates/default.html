<!doctype html>

<html>
	<head>
		<title>CompCog Psychology Experiment</title>
	    <script src="static/lib/jquery-3.4.1.min.js" type="text/javascript"></script>
	    <script src="static/lib/bootstrap-min.js"></script>
	    <link rel="stylesheet" href="static/css/bootstrap.min.css">
	    <link rel="stylesheet" type="text/css" href="static/css/style.css" media="screen" />
	</head>
	<body>
	<div class="container-flex" id="container-flyer">
	  <h1>psiTurk Experiment</h1>
		<p style="text-decoration:underline;"><a href="#" id="ad-href">Click here to begin the experiment.</a></p>
	    <script type="text/javascript">
			function makeid()
			{
			    var text = "";
			    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

			    for( var i=0; i < 5; i++ )
			        text += possible.charAt(Math.floor(Math.random() * possible.length));

			    return text;
			}

			const queryString = window.location.search;

			if(queryString.length > 0){
				const urlParams = new URLSearchParams(queryString);
				var assignmentId = urlParams.get('assignmentId');
				var hitId = urlParams.get('hitId');
				var workerId = urlParams.get('workerId');
				var mode = 'live';
				// Check prolific worker id against own id
				if(urlParams.get('workerId') == "60daf06339acaccef1a00932")
				{
					assignmentId = "debug" + assignmentId;
					hitId = "debug" + hitId;
					workerId = "debug" + makeid();
					mode = "debug";
				}
			} else {
				//debug mode
				var assignmentId = "debug" + makeid();
				var hitId = "debug" + makeid();
				var workerId = "debug" + makeid();
				var mode = "debug";
			}

			var yearLimit = 1; // put the year limit you want, can be fractional (max 1 year as of 2021 February)

			var href = "/turkprime?assignmentId=" + assignmentId + "&hitId=" + hitId + "&workerId=" + workerId + "&yearLimit=" + yearLimit+ "&mode=" + mode;

            console.log(href)
			$("#ad-href").attr("href", href);

	    </script>
	</div>
	</body>
</html>